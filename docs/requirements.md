# 服装网站新闻管理系统需求文档

## 项目概述

本项目是一个专为服装内衣行业设计的新闻管理系统，支持多语言内容管理、AI智能润色、自动采集、用户评论等功能。系统面向B2B市场，为全球服装经销商和制造商提供专业的行业资讯。

## 功能需求

### 1. AI润色功能增强

#### 1.1 新建新闻页面AI润色
- **功能描述**: 在创建新闻时提供AI润色功能，支持多模型选择和实时进度反馈
- **技术要求**:
  - 支持DeepSeek、豆包、GPT-4、Claude等多种AI模型
  - 实时显示润色进度条和当前处理状态
  - 支持多语言同时润色（中、英、日、韩等10种语言）
  - 润色完成后展示所有语言版本的结果
  - 只有润色完成后才能点击"创建新闻"按钮

#### 1.2 新闻列表AI润色
- **功能描述**: 为已存在的新闻提供批量AI润色功能
- **技术要求**:
  - 新闻列表中每条记录显示AI润色按钮
  - 点击后显示进度条和润色状态
  - 支持批量选择多条新闻进行润色
  - 润色过程中显示队列状态和预计完成时间

#### 1.3 AI模型管理
- **功能描述**: 管理和配置不同的AI模型
- **技术要求**:
  - 支持添加、删除、配置AI模型
  - 每个模型可设置不同的参数和提示词
  - 支持模型性能监控和使用统计
  - 支持模型负载均衡和故障转移

### 2. 采集过程可视化

#### 2.1 实时采集进度
- **功能描述**: 启动采集时显示详细的实时进度界面
- **显示内容**:
  - 正在采集的源数量 / 总源数量
  - 采集成功的文章数量
  - 正在润色的文章数量
  - 润色成功的文章数量
  - 当前处理的采集源名称
  - 预计完成时间

#### 2.2 采集配置
- **功能描述**: 采集前允许用户自定义配置
- **配置项**:
  - AI模型选择（DeepSeek、豆包等）
  - 目标语言选择（支持多选）
  - 采集时间限制（仅当天新闻）
  - 质量阈值设置
  - 每个源的最大采集数量

#### 2.3 采集历史记录
- **功能描述**: 记录和展示历史采集任务
- **功能要求**:
  - 显示采集时间、配置、结果统计
  - 支持查看详细的采集日志
  - 支持重新执行历史配置
  - 支持导出采集报告

### 3. 国际化多语言支持

#### 3.1 多语言内容管理
- **支持语言**: 中文、英文、日文、韩文、西班牙文、法文、德文、意大利文、葡萄牙文、俄文
- **功能要求**:
  - AI润色时自动翻译成多国语言
  - 数据库存储多语言版本
  - 支持单独编辑每种语言的内容
  - 支持语言版本的版本控制

#### 3.2 前端国际化
- **功能描述**: 根据用户地区自动显示对应语言的新闻内容
- **技术要求**:
  - 自动检测用户地区和语言偏好
  - 支持手动切换语言
  - 优雅降级到默认语言（中文）
  - SEO友好的多语言URL结构

#### 3.3 后台多语言管理
- **功能描述**: 管理员后台的多语言功能
- **功能要求**:
  - 语言选择器（默认中文，不支持全选）
  - 编辑外语新闻时提供中文翻译功能
  - 每条新闻记录显示"中文翻译"按钮
  - 支持批量翻译和批量语言操作

### 4. 数据源优化

#### 4.1 TO B新闻源
- **目标源类型**:
  - 全球纺织品贸易新闻
  - 服装制造业报告
  - 内衣行业专业资讯
  - 供应链和采购信息
  - 国际贸易政策和法规

#### 4.2 多国家RSS源
- **地区覆盖**:
  - 亚洲：中国、日本、韩国、印度、越南、孟加拉国
  - 欧洲：德国、意大利、法国、英国、土耳其
  - 美洲：美国、墨西哥、巴西
  - 其他：埃及、摩洛哥等纺织品出口国

#### 4.3 质量控制
- **功能要求**:
  - 提高质量阈值到75-85分
  - 智能去重和内容聚合
  - 关键词过滤和分类
  - 内容质量评分算法优化

### 5. 定时采集功能

#### 5.1 采集规则配置
- **功能描述**: 允许管理员自定义采集规则和时间间隔
- **配置项**:
  - Cron表达式设置
  - 采集源选择
  - AI模型和语言配置
  - 质量阈值和数量限制
  - 通知和报告设置

#### 5.2 最优采集策略
- **基于大数据经验的建议**:
  - 时尚零售：工作日早上8-9点采集
  - 内衣B2B：每日上午9点，质量阈值82分
  - 全球趋势：一天三次（6点、14点、22点）
  - 行业报告：每周一上午10点

#### 5.3 智能调度
- **功能要求**:
  - 自动负载均衡
  - 失败重试机制
  - 采集源健康监控
  - 动态调整采集频率

### 6. 评论系统

#### 6.1 用户管理
- **功能描述**: 用户注册、登录和权限管理
- **用户类型**:
  - 游客：只能查看评论
  - 注册用户：可以评论和回复
  - 管理员：可以管理所有评论

#### 6.2 评论功能
- **基础功能**:
  - 发表评论和回复
  - 支持嵌套评论（最多3层）
  - 评论点赞和举报
  - 评论编辑和删除

#### 6.3 隐私保护
- **功能要求**:
  - 游客和普通用户看到的评论者姓名打星号隐藏
  - 管理员可查看真实评论者信息
  - 支持匿名评论选项
  - 敏感信息自动过滤

#### 6.4 管理功能
- **管理员功能**:
  - 查看所有评论和用户信息
  - 删除评论（包括所有子评论）
  - 批量管理和审核
  - 评论统计和分析

## 技术要求

### 1. 性能要求
- **响应时间**: 页面加载时间 < 2秒
- **并发处理**: 支持1000+并发用户
- **数据库查询**: 复杂查询 < 500ms
- **AI处理**: 单篇文章润色 < 30秒

### 2. 安全要求
- **数据加密**: 敏感数据AES-256加密
- **访问控制**: 基于角色的权限管理
- **API安全**: JWT认证 + Rate Limiting
- **内容安全**: XSS和SQL注入防护

### 3. 可扩展性
- **微服务架构**: 支持水平扩展
- **缓存策略**: Redis多级缓存
- **CDN支持**: 静态资源全球分发
- **数据库**: 支持读写分离和分库分表

### 4. 监控和日志
- **系统监控**: CPU、内存、磁盘使用率
- **业务监控**: 采集成功率、AI处理成功率
- **错误日志**: 详细的错误追踪和报警
- **用户行为**: 访问统计和行为分析

## 数据库设计

### 1. 多语言支持
```sql
-- 新闻表
CREATE TABLE news_articles (
  id VARCHAR(50) PRIMARY KEY,
  category VARCHAR(20),
  status VARCHAR(20),
  source_type VARCHAR(20),
  ai_processed BOOLEAN,
  ai_model VARCHAR(20),
  polished_languages JSON,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);

-- 多语言内容表
CREATE TABLE news_content (
  id VARCHAR(50) PRIMARY KEY,
  news_id VARCHAR(50),
  language VARCHAR(5),
  title TEXT,
  content LONGTEXT,
  summary TEXT,
  FOREIGN KEY (news_id) REFERENCES news_articles(id)
);
```

### 2. 评论系统
```sql
-- 用户表
CREATE TABLE users (
  id VARCHAR(50) PRIMARY KEY,
  username VARCHAR(50) UNIQUE,
  email VARCHAR(100) UNIQUE,
  display_name VARCHAR(100),
  role VARCHAR(20),
  created_at TIMESTAMP
);

-- 评论表
CREATE TABLE comments (
  id VARCHAR(50) PRIMARY KEY,
  news_id VARCHAR(50),
  user_id VARCHAR(50),
  parent_id VARCHAR(50),
  content TEXT,
  is_deleted BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP,
  FOREIGN KEY (news_id) REFERENCES news_articles(id),
  FOREIGN KEY (user_id) REFERENCES users(id)
);
```

## API设计

### 1. 多语言新闻API
```
POST /api/admin/news/multilingual - 创建多语言新闻
GET /api/admin/news/multilingual?language=zh - 获取指定语言新闻
PUT /api/admin/news/multilingual - 更新多语言内容
```

### 2. AI润色API
```
POST /api/admin/news/polish - 启动AI润色
GET /api/admin/news/polish/progress/:jobId - 获取润色进度
GET /api/admin/news/polish/result/:jobId - 获取润色结果
```

### 3. 采集API
```
POST /api/admin/news/crawl - 启动采集任务
GET /api/admin/news/crawl/progress/:jobId - 获取采集进度
GET /api/admin/news/crawl/history - 获取采集历史
```

### 4. 评论API
```
GET /api/comments/:newsId - 获取新闻评论
POST /api/comments - 发表评论
PUT /api/comments/:id - 编辑评论
DELETE /api/comments/:id - 删除评论
```

## 部署要求

### 1. 环境配置
- **Node.js**: >= 18.0.0
- **数据库**: MySQL 8.0+ 或 PostgreSQL 14+
- **缓存**: Redis 6.0+
- **搜索**: Elasticsearch 8.0+

### 2. 服务器配置
- **CPU**: 8核心以上
- **内存**: 16GB以上
- **存储**: SSD 500GB以上
- **网络**: 100Mbps以上带宽

### 3. 容器化部署
- **Docker**: 支持Docker容器化部署
- **Kubernetes**: 支持K8s集群部署
- **CI/CD**: GitHub Actions自动化部署
- **监控**: Prometheus + Grafana

## 测试要求

### 1. 单元测试
- **覆盖率**: 代码覆盖率 > 80%
- **工具**: Jest + Testing Library
- **范围**: 所有核心业务逻辑

### 2. 集成测试
- **API测试**: 所有API接口测试
- **数据库测试**: 数据一致性测试
- **第三方服务**: AI服务和RSS源测试

### 3. 性能测试
- **负载测试**: 模拟1000+并发用户
- **压力测试**: 系统极限性能测试
- **稳定性测试**: 长时间运行稳定性

### 4. 安全测试
- **渗透测试**: 常见安全漏洞检测
- **数据安全**: 敏感数据保护测试
- **权限测试**: 访问控制和权限验证
